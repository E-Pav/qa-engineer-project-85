---
- summary: |
    Успешная регистрации пользователя
  requirement: |
    Пользователь должен иметь возможность зарегистрироваться на сайте
  prerequisites: |
    Открыта главная страница сайта URL https://codebattle.hexlet.io/
  test-data: |
    Nickname: VasyaTuT
    Email: test1@gmail.co 
    Password: KuKu2025)
    Password Confirmation: KuKu2025)  
  steps:
    - Нажать на кнопку "Sign up"
    - Должна появиться форма регистрации с полями: Nickname, Email, Password, Password Confirmation
    - Вводим Nickname
    - Вводим Email
    - Вводим Password
    - Вводим Password Confirmation
    - Нажимаем кнопку Submit
  expected-result: |
    Пользователь должен успешно зарегистрироваться и быть перенаправлен в личный кабинет
    Имя пользователя отображается в правом верхнем углу

- summary: |
    Валидация обязательных полей при регистрации
  requirement: |
    Система должна предотвращать регистрацию и информировать пользователя о необходимости заполнения обязательных полей
  prerequisites: |
    no-data
  test-data: |
    Поле 'Nickname' пустое
    Поле 'Email' пустое
    Поле 'Password' пустое
    Поле 'Password Confirmation' пустое
  steps:
    - Оставить поля 'Nickname', 'Email', 'Password', 'Password Confirmation' пустыми.
    - Нажать кнопку 'Зарегистрироваться' (Submit)
  expected-result: |
    Отображается сообщение об обязательности заполнения полей. Пользователь остается на странице регистрации

- summary: |
    Проверка аутентификации по почте и паролю
  requirement: |
    При вводе корректной почты и пароля (уже зарегистрированного пользователя) происходит вход в систему
  prerequisites: |
    Открыта главная страница сайта URL https://codebattle.hexlet.io/
    Зарегистрирован пользователь с данными: email: test1@gmail.com Pass: KuKu2025
  test-data: |
    Email: test1@gmail.co 
    Password: KuKu2025)   
  steps:
    - Нажать на кнопку "Sign in"
    - Должна появиться форма регистрации с полями: Email, Password
    - Вводим Email
    - Вводим Password
    - Нажимаем кнопку Submit
  expected-result: |
    Пользователь попадает в личный кабинет
    Имя пользователя отображается в правом верхнем углу

- summary: |
    Проверка входа через GitHub
  requirement: |
    При подтверждении с GitHub происходит вход в систему
  prerequisites: |
    Открыта главная страница сайта URL https://codebattle.hexlet.io/
  test-data: |
    no-data
  steps:
    - Нажать на кнопку "Sign in"
    - Нажать на кнопку "Sign in with GitHub"
    - При перенаправлении на GitHub подтвердить вход
  expected-result: |
    Пользователь попадает в личный кабинет
    Имя пользователя GitHub отображается в правом верхнем углу

- summary: |
    Проверка ошибки при вводе неправильного пароля
  requirement: |
    При вводе неправильных данных должна отображаться ошибка
  prerequisites: |
    Зарегистрирован пользователь Email: test1@gmail.co Password: KuKu2025)
    Открыта главная страница сайта https://codebattle.hexlet.io/
  test-data: |
    Email = test1@gmail.co
    Password = Ha!Ha!2025
  steps:
    - Нажать "Sign in"
    - Ввести email
    - Ввести неверный пароль
    - Нажать кнопку "Submit"
  expected-result: |
    Появляется сообщение об ошибке "Invalid password"
    Пользователь не входит в систему

- summary: |
    Проверка ошибки при вводе неправильного электронного адреса
  requirement: |
    При вводе неправильных данных должна отображаться ошибка
  prerequisites: |
    Зарегистрирован пользователь Email: test1@gmail.co Password: KuKu2025)
    Открыта главная страница сайта https://codebattle.hexlet.io/
  test-data: |
    Email = NeBudu@gm.com
    Password = KuKu2025
  steps:
    - Нажать "Sign in"
    - Ввести неверный email
    - Ввести пароль
    - Нажать кнопку "Submit"
  expected-result: |
    Появляется сообщение об ошибке "Email not found"
    Пользователь не входит в систему

- summary: |
    Проверка мобильной версии
  requirement: |
    Корректное отображение страниц при простмотре с мобильного устройства
  prerequisites: |
    Открыта главная страница сайта URL https://codebattle.hexlet.io/
  test-data: |
    Email: test1@gmail.co 
    Password: KuKu2025)    
  steps:
    - Открыть DevTools в браузере
    - Выбрать отображение в любом мобильном устройстве
    -  * Проверить отсутствие горизонтального скролла
    -  * Проверить что масштаб страницы соответствует устройству
    -  * Проверить что кнопки не мелкие и легко нажимаются
    - Пройти авторизацию (кнопка "Sign in")
    - Пройти по меню (My profile, Settings, User rating и т.д.)
    - Создать тестовое сообщение в чате
    - Перейти к созданию игры - Кнопка "Create game"
    - Проверить фильтры сложности, типа заданий, список заданий
    - Создать игру с ботом
    - Протестировать ввод кода, переключение языка программирования
    - Проверить отображение кода противника в игре
  expected-result: |
    Открывается мобильная версия сайта, всё корректно отображается

- summary: |
    Старт игры с ботом 
  requirement: |
    Игра запускается, появляется редактор кода, в противниках — бот
  prerequisites: |
    Пользователь авторизован
  test-data: |
    Email: test1@gmail.co 
    Password: KuKu2025)
  steps:
    - Нажать 'Create a Game'
    - Выбрать 'With a bot'
    - Остальные параметры (время, виды игры, уровень) изменить произвольно или оставить как есть
    - Нажать Create battle     
  expected-result: |
    Игра запускается, появляется редактор кода, таймер отсчитывает время, в противниках — бот

- summary: |
    Проверка возможности присоединиться к открытой игре
  requirement: |
    Пользователь должен иметь возможность участвовать в игре
  prerequisites: |
    Пользователь авторизован
    Открыта главная страница сайта
  test-data: |
    empty
  steps:
    - На главной странице найти раздел Lobby
    - Найти доступную игру из списка
    - Справа нажать кнопку "Fight"
  expected-result: |
    Пользователь подключается к игре и попадает в интерфейс с редактором кода

- summary: |
    Старт игры с другом 
  requirement: |
    Игра запускается, появляется редактор кода, в противниках — пользователь
  prerequisites: |
    Оба Пользователя авторизованы
  test-data: |
    no-data
  steps:
    - Нажать 'Create a Game'
    - Выбрать 'With a friend'
    - Выбрать оппонента из списка 'Choose opponent'
    - Остальные параметры (время, виды игры, уровень) изменить произвольно или оставить как есть
    - Нажать Create battle
    - Отправляется приглашение другу, после его подтверждения происходит переход на страницу игры с выбранными параметрами (задание, время)     
  expected-result: |
    Игра запускается, появляется редактор кода, таймер отсчитывает время, в противниках — выбранный пользователь

- summary: |
    Старт игры со случайным пользователем 
  requirement: |
    Игра запускается, появляется редактор кода, в противниках — случайный пользователь
  prerequisites: |
    Оба Пользователя авторизованы, открыта главная страница
  test-data: |
    no-data
  steps:
    - Нажать 'Create a Game'
    - Выбрать 'With other user'
    - Остальные параметры (время, виды игры, уровень) изменить произвольно или оставить как есть
    - Нажать Create battle
    - Имя игрока и уровень игры появляется в списке "Lobby" на главной странице с кнопкой "Continue", "Copy link" и "Cancel"
    - У другого юзера появляется эта игра в списке "Lobby" с кнопкой "Fight"
    - После принятия игры (нажатие на кнопку "Fight" вторым пользователем) происходит перенаправление обоих на страницу игры        
  expected-result: |
    Игра запускается, появляется редактор кода, таймер отсчитывает время, в противниках — второй пользователь

- summary: |
    Переключение языков программирования 
  requirement: |
    Переключение языков программирования во время игры
  prerequisites: |
    Запущена игра, открыт редактор кода
  test-data: |
    Доступные языки: 
    Clojure, C++, C#, Dart, Elixir, Golang, Haskell, Java, Node.js, Python, Ruby, Rust, Typescript
  steps:
    - В выпадающем списке слева выбрать произвольный язык программирования
    - Убедиться, что редактор кода использует выбранный язык (подсветка синтаксиса, шаблон)
    - Нажать на выпадающий список языка (вверху редактора)
    - Выбрать другой язык (например, JavaScript)
    - Убедиться, что редактор обновил шаблон и синтаксис под новый язык
    - Повторить со всеми языками из списка
  expected-result: |
    Во время матча язык можно изменить с помощью выпадающего списка
    Изменения применяются сразу: шаблон, синтаксис, автоподстановка
    Никаких ошибок или перезагрузок страницы не происходит

- summary: |
    Победа 
  requirement: |
    Победа в игре, появление экрана с надписью 'Woohoo, you're Champion!!!!!'
  prerequisites: |
    Запущена игра, введён верный код для выполнения задания игры
  test-data: |
    Для образца - игра age_to_days (rest, 1-star)
    Язык Java24
    Заменить c "Integer ans = 0;"  на
    "Integer ans = age * 365;"
    Либо либая другая игра
  steps:
    - Ввести код 
    - Нажать кнопку Run раньше оппонента и до истечения таймера игры
  expected-result: |
    На заднем фоне открыто окно 'Output' с результатами проверок кода, на переднем плане - всплывающее окно с победной картинкой и нандписью 'Woohoo, you're Champion!!!!!'

- summary: |
    Поражение по коду
  requirement: |
    Проигрыш в игре, появление экрана с надписью 'Game over'
  prerequisites: |
    Запущена игра, противник вводит верный код
  test-data: |
    Для образца - игра celsius_to_kelvin (rest, 1-star)
    Язык Java24
    Заменить c "Integer ans = 0;"  на
    "Integer ans = celsius_to_kelvin;"
    Либо либая другая игра
  steps:
    - Противник вводит правильный код и нажимает "Run" до истечения таймер игры  
  expected-result: |
    На переднем плане - всплывающее окно с картинкой поражения и нандписью 'Game over'

- summary: |
    Поражение по Кнопке сдаться
  requirement: |
    Проигрыш в игре, появление экрана с надписью 'Game over'
  prerequisites: |
    Запущена произвольная игра
  test-data: |
    no data
  steps:
    - Нажать кнопку "Give Up" (скрыта в подменю с тремя точками, рядом с кнопкой "Run")
    - На всплывающем окне нажать кнопку "Give up" (подтвердить сдачу)
  expected-result: |
    На переднем плане - всплывающее окно с картинкой поражения и нандписью 'Game over'

- summary: |
    Окончание игры по таймеру
  requirement: |
    Окончание игры по окончанию обратного отсчёта времени
  prerequisites: |
    Запущена произвольная игра, таймер установлен на произвольное значение (желательно небольшое)
  test-data: |
    no data
  steps:
    - Дождаться окончания таймера не запуская корректный для победы код
  expected-result: |
    С правой стороны экрана появляется надпись "Time is up. There is no winner"

- summary: |
    Проверка отправки сообщений в общий чат авторизованным пользователем
  requirement: |
    Авторизованный пользователь должен иметь возможность отправлять сообщения в чат
  prerequisites: |
    Пользователь авторизован
    Открыта главная страница сайта https://codebattle.hexlet.io/
  test-data: |
    Сообщение = "Hello all)"
  steps:
    - Найти поле ввода сообщения
    - Ввести текст "Hello all)"
    - Нажать "Send"
  expected-result: |
    Сообщение появляется в общем чате
    C именем пользователя и временем отправки

- summary: |
    Проверка защиты сайта протоколом HTTPS
  requirement: |
    Все соединения должны использовать защищённый протокол HTTPS
  prerequisites: |
    Открыт браузер (Chrome, Firefox, Edge и др.)
    Открыта главная страница сайта https://codebattle.hexlet.io/
  test-data: |
    URL https://codebattle.hexlet.io/
  steps:
    - Проверить наличие значка 🔒 в браузере
    - Открыть DevTools -> вкладка Privacy and Security
    - Убедитесь что страница защищена HTTPS, TLS1.2 и TLS1.3
    - Ввести в строке мануально http://codebattle.hexlet.io/
    - Нажать Enter
    - Проверить что браузер переводит URL в https://
  expected-result: |
    Продукт защищен протоколом HTTPS

- summary: |
    Проверка защиты от XSS
  requirement: |
    Все соединения продукта должны быть защищены от XSS
  prerequisites: |
    Открыта главная страница сайта https://codebattle.hexlet.io/
  test-data: |
    Вредоносный скрипт: <script>alert('XSS');</script>  
    Вредоносный URL: https://codebattle.hexlet.io/?q=<script>alert('XSS')</script>
  steps:
    - Вводим XSS скрипт <script>alert('XSS');</script> в строку чата на главной странице
    - Нажимаем Send
    - Проверяем что введенный скрипт отображается в результатах поиска как обычный текст
    - Проверяем что не выпадает никаких всплывающих окон
    - Проверяем текст и вносим вредоносное XSS прямо в браузер URL адреса
    - Вводим URL https://codebattle.hexlet.io/?q=<script>alert('XSS')</script>
    - Нажимаем Enter
    - Проверяем что не выпадает никаких всплывающих окон
    - Перезагружаем сайт
    - Еще раз проверяем что нет всплывающих окон
  expected-result: |
    В поиске текст "<script>alert('XSS');</script>" отображается как обычный текст, без выполнения кода
    В консоли браузера нет ошибок, связанных с выполнением XSS-кода

- summary: |
    Проверка автоматического выхода после удаления куки (истечение сессии)
  requirement: |
    После удаления сессионных куков пользователь должен быть разлогинен
  prerequisites: |
    Пользователь авторизован
    Открыта главная страница сайта https://codebattle.hexlet.io/
    Открыты DevTools (F12)
  test-data: |
    empty
  steps:
    - Открыть вкладку "Application" -> "Cookies"
    - Нажать правой кнопкой мыши (clear)
    - Отчищаем все cookies для домена codebattle.hexlet.io
    - Обновить страницу (F5)
  expected-result: |
    Пользователь автоматически выходит из системы
    Пользователь перенаправляется на стартовую страницу https://codebattle.hexlet.io/#lobby